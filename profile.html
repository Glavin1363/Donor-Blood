<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Profile | DonorConnect</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
    <style>
        .navbar {
            background-color: var(--dark-color); /* Set background color */
            padding: 10px 0; /* Add padding */
        }

        .navbar ul {
            list-style: none; /* Remove default list styles */
            display: flex; /* Use flexbox for horizontal layout */
            justify-content: space-around; /* Space items evenly */
            margin: 0; /* Remove default margin */
            padding: 0; /* Remove default padding */
        }

        .navbar ul li {
            margin: 0 15px; /* Space between menu items */
        }

        .navbar ul li a {
            color: #121212; /* Set text color */
            text-decoration: none; /* Remove underline */
            font-weight: 500; /* Set font weight */
            transition: color 0.3s ease; /* Smooth transition for hover effect */
        }

        .navbar ul li a:hover {
            color: var(--primary-color); /* Change color on hover */
        }

        .profile-container {
            display: flex;
            min-height: calc(100vh - 70px);
            margin-top: 70px;
        }
        
        .profile-sidebar {
            width: 300px;
            background-color: var(--white);
            padding: 30px;
            box-shadow: 5px 0 15px rgba(0, 0, 0, 0.05);
        }
        
        .profile-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .profile-avatar {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background-color: var(--primary-light);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            font-size: 2.5rem;
            font-weight: 600;
            color: var(--primary-dark);
            position: relative;
            overflow: hidden;
        }
        
        .profile-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .profile-avatar-edit {
            position: absolute;
            bottom: 0;
            right: 0;
            width: 40px;
            height: 40px;
            background-color: var(--primary-color);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            cursor: pointer;
        }
        
        .profile-name h2 {
            font-size: 1.5rem;
            margin-bottom: 5px;
            color: var(--dark-color);
        }
        
        .profile-name p {
            color: var(--gray-color);
            font-size: 0.9rem;
        }
        
        .profile-badge {
            display: inline-block;
            padding: 5px 15px;
            background-color: var(--primary-light);
            color: var(--primary-dark);
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            margin-top: 10px;
        }
        
        .profile-stats {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 25px 0;
            padding: 20px 0;
            border-top: 1px solid #eee;
            border-bottom: 1px solid #eee;
        }
        
        .profile-stat {
            text-align: center;
        }
        
        .profile-stat h3 {
            font-size: 1.5rem;
            color: var(--primary-color);
            margin-bottom: 5px;
        }
        
        .profile-stat p {
            font-size: 0.8rem;
            color: var(--gray-color);
        }
        
        .profile-actions {
            margin-top: 20px;
        }
        
        .profile-actions .btn {
            width: 100%;
            margin-bottom: 10px;
        }
        
        .profile-content {
            flex: 1;
            padding: 30px;
            background-color: var(--light-color);
        }
        
        .profile-section {
            background-color: var(--white);
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .section-header h2 {
            font-size: 1.3rem;
            color: var(--dark-color);
        }
        
        .section-header button {
            background: none;
            border: none;
            color: var(--primary-color);
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .info-item {
            margin-bottom: 15px;
        }
        
        .info-item h3 {
            font-size: 0.9rem;
            color: var(--gray-color);
            margin-bottom: 5px;
        }
        
        .info-item p {
            font-size: 1rem;
            color: var(--dark-color);
        }
        
        .edit-form .form-group {
            margin-bottom: 15px;
        }
        
        .edit-form label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--dark-color);
            font-size: 0.9rem;
        }
        
        .edit-form input, 
        .edit-form select, 
        .edit-form textarea {
            width: 100%;
            padding: 10px 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-family: 'Poppins', sans-serif;
            font-size: 1rem;
        }
        
        .edit-form textarea {
            min-height: 100px;
        }
        
        .form-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 20px;
        }
        
        .donation-history {
            width: 100%;
            border-collapse: collapse;
        }
        
        .donation-history th {
            text-align: left;
            padding: 12px 15px;
            background-color: #f8f9fa;
            color: var(--gray-color);
            font-weight: 500;
            font-size: 0.9rem;
        }
        
        .donation-history td {
            padding: 12px 15px;
            border-bottom: 1px solid #eee;
            font-size: 0.9rem;
        }
        
        .donation-history tr:last-child td {
            border-bottom: none;
        }
        
        .status-badge {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
        }
        
        .status-badge.completed {
            background-color: #d4edda;
            color: #155724;
        }
        
        .status-badge.upcoming {
            background-color: #fff3cd;
            color: #856404;
        }
        
        .status-badge.cancelled {
            background-color: #f8d7da;
            color: #721c24;
        }
        
        .mobile-profile-toggle {
            display: none;
            background-color: var(--primary-color);
            color: var(--white);
            padding: 10px 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            font-weight: 500;
        }

        .header {
            background-color: #fff; /* Adjust as needed */
            padding: 10px 0; /* Reduce vertical padding */
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1); /* Optional shadow */
        }

        .container {
            display: flex;
            align-items: center; /* Center items vertically */
            justify-content: flex-start; /* Align items to the left */
            max-width: 1200px; /* Adjust max width as needed */
            margin: 0; /* Remove auto margin to align to the left */
            padding: 0 15px; /* Add horizontal padding */
        }

        .header-content {
    display: flex;
    align-items: center; /* Center items vertically */
    margin-left: 10px; /* Add a small margin to move content slightly to the right */
}

.back-button {
    margin-right: 6px; /* Space between back button and logo */
}

.logo {
    display: flex;
    align-items: center; /* Center logo and text vertically */
}

.logo img {
    height: 60px; /* Adjust logo height as needed */
    margin-right: 1px; /* Reduced space between logo and text */
}

.logo span {
    font-size: 1.5rem; /* Adjust font size as needed */
    color: #333; /* Adjust text color as needed */
}
        
        @media (max-width: 992px) {
            .profile-sidebar {
                position: fixed;
                left: -300px;
                top: 70px;
                bottom: 0;
                z-index: 999;
                transition: left 0.3s ease;
            }
            
            
            .profile-sidebar.active {
                left: 0;
            }
            
            .profile-content {
                margin-left: 0;
            }
            
            .mobile-profile-toggle {
                display: flex;
                align-items: center;
            }
        }
        
        @media (max-width: 768px) {
            .info-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="back-button">
                    <button id="back-btn" class="btn btn-outline">
                        &larr; <!-- This is the left arrow symbol -->
                    </button>
                </div>
                <div class="logo">
                    <img src="images/logo.png" alt="DonorConnect Logo">
                    <span>DonorConnect</span>
                </div>
            </div>
        </div>
    </header>
            <nav class="navbar">
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="about.html">About Us</a></li>
                    <li><a href="register.html">Register</a></li>
                    <li><a href="media.html">Media</a></li>
                    <li><a href="login.html">Login</a></li>
                    <li><a href="contact.html">Contact</a></li>
                </ul>
            </nav>
           <div class="mobile-menu">
                <i class="fas fa-bars"></i>
            </div>
        </div>
    </header>

    <div class="profile-container">
        <div class="profile-sidebar">
            <div class="profile-header">
                <div class="profile-avatar">
                    <span id="profile-initials"></span>
                    <div class="profile-avatar-edit">
                        <i class="fas fa-camera"></i>
                    </div>
                </div>
                <div class="profile-name">
                    <h2 id="profile-full-name"></h2>
                    <p id="profile-role"></p>
                    <span class="profile-badge" id="profile-blood-group"></span>
                </div>
            </div>
            
            <div class="profile-stats">
                <div class="profile-stat">
                    <h3 id="profile-donations"></h3>
                    <p>Donations</p>
                </div>
                <div class="profile-stat">
                    <h3 id="profile-lives-saved"></h3>
                    <p>Lives Saved</p>
                </div>
            </div>
            
            <div class="profile-actions">
                <button class="btn btn-primary" id="edit-personal-info-btn">
                    <i class="fas fa-edit"></i> Edit Profile
                </button>
                <button class="btn btn-outline">
                    <i class="fas fa-share-alt"></i> Share Profile
                </button>
                <button class="btn btn-outline" style="color: var(--danger-color); border-color: var(--danger-color);">
                    <i class="fas fa-ban"></i> Deactivate
                </button>
            </div>
        </div>
        
        <div class="profile-content">
            <button class="mobile-profile-toggle" id="profile-toggle">
                <i class="fas fa-user"></i> Profile Summary
            </button>
            
            <div class="profile-section">
                <div class="section-header">
                    <h2>Personal Information</h2>
                    <button id="edit-personal-info"><i class="fas fa-edit"></i> Edit</button>
                </div>
                
                <div class="info-grid" id="personal-info-view">
                    <div class="info-item">
                        <h3>Full Name</h3>
                        <p id="full-name"></p>
                    </div>
                    <div class="info-item">
                        <h3>Date of Birth</h3>
                        <p id="dob"></p>
                    </div>
                    <div class="info-item">
                        <h3>Gender</h3>
                        <p id="gender"></p>
                    </div>
                    <div class="info-item">
                        <h3>Email</h3>
                        <p id="email"></p>
                    </div>
                    <div class="info-item">
                        <h3>Phone</h3>
                        <p id="phone"></p>
                    </div>
                    <div class="info-item">
                        <h3>Location</h3>
                        <p id="location"></p>
                    </div>
                </div>
                
                <form class="edit-form" id="personal-info-edit" style="display: none;">
                    <div class="form-row" style="display: flex; gap: 20px; margin-bottom: 15px;">
                        <div class="form-group" style="flex: 1;">
                            <label for="edit-first-name">First Name</label>
                            <input type="text" id="edit-first-name">
                        </div>
                        <div class="form-group" style="flex: 1;">
                            <label for="edit-last-name">Last Name</label>
                            <input type="text" id="edit-last-name">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="edit-dob">Date of Birth</label>
                        <input type="date" id="edit-dob">
                    </div>
                    
                    <div class="form-group">
                        <label for="edit-gender">Gender</label>
                        <select id="edit-gender">
                            <option value="male">Male</option>
                            <option value="female">Female</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="edit-email">Email</label>
                        <input type="email" id="edit-email">
                    </div>
                    
                    <div class="form-group">
                        <label for="edit-phone">Phone</label>
                        <input type="tel" id="edit-phone">
                    </div>
                    
                    <div class="form-group">
                        <label for="edit-address">Address</label>
                        <textarea id="edit-address"></textarea>
                    </div>
                    
                    <div class="form-actions">
                        <button type="button" class="btn btn-outline" id="cancel-personal-info">Cancel</button>
                        <button type="button" class="btn btn-primary" id="save-personal-info">Save Changes</button>
                    </div>
                </form>
            </div>
            
            <div class="profile-section">
                <div class="section-header">
                    <h2>Health Information</h2>
                    <button id="edit-health-info"><i class="fas fa-edit"></i> Edit</button>
                </div>
                
                <div class="info-grid" id="health-info-view">
                    <div class="info-item">
                        <h3>Blood Group</h3>
                        <p id="blood-group"></p>
                    </div>
                    <div class="info-item">
                        <h3>Height</h3>
                        <p id="height"></p>
                    </div>
                    <div class="info-item">
                        <h3>Weight</h3>
                        <p id="weight"></p>
                    </div>
                    <div class="info-item">
                        <h3>Organ Donor</h3>
                        <p id="organ-donor"></p>
                    </div>
                    <div class="info-item">
                        <h3>Organs Willing to Donate</h3>
                        <p id="organs"></p>
                    </div>
                    <div class="info-item">
                        <h3>Medical History</h3>
                        <p id="medical-history"></p>
                    </div>
                </div>
                
                <form class="edit-form" id="health-info-edit" style="display: none;">
                    <div class="form-group">
                        <label for="edit-blood-group">Blood Group</label>
                        <select id="edit-blood-group">
                            <option value="A+">A+</option>
                            <option value="A-">A-</option>
                            <option value="B+">B+</option>
                            <option value="B-">B-</option>
                            <option value="AB+">AB+</option>
                            <option value="AB-">AB-</option>
                            <option value="O+">O+</option>
                            <option value="O-">O-</option>
                        </select>
                    </div>
                    
                    <div class="form-row" style="display: flex; gap: 20px;">
                        <div class="form-group" style="flex: 1;">
                            <label for="edit-height">Height (cm)</label>
                            <input type="number" id="edit-height">
                        </div>
                        <div class="form-group" style="flex: 1;">
                            <label for="edit-weight">Weight (kg)</label>
                            <input type="number" id="edit-weight">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Organ Donor</label>
                        <div style="display: flex; gap: 20px;">
                            <div>
                                <input type="radio" id="edit-organ-donor-yes" name="edit-organ-donor" value="yes">
                                <label for="edit-organ-donor-yes">Yes</label>
                            </div>
                            <div>
                                <input type="radio" id="edit-organ-donor-no" name="edit-organ-donor" value="no">
                                <label for="edit-organ-donor-no">No</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Organs Willing to Donate</label>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                            <div>
                                <input type="checkbox" id="edit-organ-kidney" name="organs[]" value="kidney">
                                <label for="edit-organ-kidney">Kidney</label>
                            </div>
                            <div>
                                <input type="checkbox" id="edit-organ-liver" name="organs[]" value="liver">
                                <label for="edit-organ-liver">Liver</label>
                            </div>
                            <div>
                                <input type="checkbox" id="edit-organ-heart" name="organs[]" value="heart">
                                <label for="edit-organ-heart">Heart</label>
                            </div>
                            <div>
                                <input type="checkbox" id="edit-organ-lungs" name="organs[]" value="lungs">
                                <label for="edit-organ-lungs">Lungs</label>
                            </div>
                            <div>
                                <input type="checkbox" id="edit-organ-pancreas" name="organs[]" value="pancreas">
                                <label for="edit-organ-pancreas">Pancreas</label>
                            </div>
                            <div>
                                <input type="checkbox" id="edit-organ-eyes" name="organs[]" value="eyes">
                                <label for="edit-organ-eyes">Eyes</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="edit-medical-history">Medical History</label>
                        <textarea id="edit-medical-history"></textarea>
                    </div>
                    
                    <div class="form-actions">
                        <button type="button" class="btn btn-outline" id="cancel-health-info">Cancel</button>
                        <button type="button" class="btn btn-primary" id="save-health-info">Save Changes</button>
                    </div>
                </form>
            </div>
            
            <div class="profile-section">
                <div class="section-header">
                    <h2>Donation History</h2>
                    <button><i class="fas fa-download"></i> Export</button>
                </div>
                
                <div class="table-responsive">
                    <table class="donation-history">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Type</th>
                                <th>Location</th>
                                <th>Status</th>
                                <th>Recipient</th>
                            </tr>
                        </thead>
                        <tbody id="donation-history-body">
                            <!-- Donation history will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <div class="profile-section">
                <div class="section-header">
                    <h2>Upcoming Donations</h2>
                    <button><i class="fas fa-plus"></i> Add</button>
                </div>
                
                <div class="table-responsive">
                    <table class="donation-history">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Type</th>
                                <th>Location</th>
                                <th>Status</th>
                                <th>Recipient</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="upcoming-donations-body">
                            <!-- Upcoming donations will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <footer class="footer">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-col">
                    <div class="logo">
                        <img src="images/logo.png" alt="DonorConnect Logo">
                        <span>DonorConnect</span>
                    </div>
                    <p>Connecting blood and organ donors with recipients to save lives through secure and efficient technology.</p>
                    <div class="social-links">
                        <a href="#"><i class="fab fa-facebook-f"></i></a>
                        <a href="#"><i class="fab fa-twitter"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                        <a href="#"><i class="fab fa-linkedin-in"></i></a>
                    </div>
                </div>
                <div class="footer-col">
                    <h3>Quick Links</h3>
                    <ul>
                        <li><a href="index.html">Home</a></li>
                        <li><a href="about.html">About Us</a></li>
                        <li><a href="register.html">Register</a></li>
                        <li><a href="login.html">Login</a></li>
                        <li><a href="contact.html">Contact</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h3>Resources</h3>
                    <ul>
                        <li><a href="#">Blood Donation Guide</a></li>
                        <li><a href="#">Organ Donation FAQs</a></li>
                        <li><a href="#">Eligibility Criteria</a></li>
                        <li><a href="#">Success Stories</a></li>
                        <li><a href="#">Blog</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h3>Contact Us</h3>
                    <ul>
                        <li><i class="fas fa-map-marker-alt"></i> 123 Health Street, Mumbai, India</li>
                        <li><i class="fas fa-phone"></i> +91 9876543210</li>
                        <li><i class="fas fa-envelope"></i> <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="a8c1c6cec7e8ccc7c6c7dacbc7c6c6cdcbdc86c7dacf">[email&#160;protected]</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2023 DonorConnect. All rights reserved.</p>
                <div class="footer-links">
                    <a href="#">Privacy Policy</a>
                    <a href="#">Terms of Service</a>
                    <a href="#">Cookie Policy</a>
                </div>
            </div>
        </div>
    </footer>

    <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script>
    <script src="js/script.js"></script>
    <script>
        // Add functionality to the back button
        document.getElementById('back-btn').addEventListener('click', function() {
            window.location.href = 'dashboard.html'; // Navigate to dashboard.html
        });

        document.addEventListener('DOMContentLoaded', function() {
            // Check if user is logged in
            const isLoggedIn = localStorage.getItem('isLoggedIn');
            const currentUser  = JSON.parse(localStorage.getItem('currentUser '));
    
            // If not logged in or no user data, redirect to login
            if (isLoggedIn !== 'true' || !currentUser ) {
                localStorage.removeItem('isLoggedIn');
                localStorage.removeItem('currentUser ');
                window.location.href = 'login.html';
                return; // Stop further execution
            }
    
            // Populate profile data
            document.getElementById('profile-initials').textContent = currentUser .firstName.charAt(0) + currentUser .lastName.charAt(0);
            document.getElementById('profile-full-name').textContent = `${currentUser .firstName} ${currentUser .lastName}`;
            document.getElementById('profile-role').textContent = currentUser .userType === 'donor' ? 'Blood Donor' : 'Recipient';
            document.getElementById('profile-blood-group').textContent = currentUser .bloodGroup || 'N/A';
            document.getElementById('profile-donations').textContent = currentUser .donations || '0';
            document.getElementById('profile-lives-saved').textContent = currentUser .livesSaved || '0';
    
            // Populate additional profile details
            document.getElementById('full-name').textContent = `${currentUser .firstName} ${currentUser .lastName}`;
            document.getElementById('dob').textContent = currentUser .dob || 'N/A';
            document.getElementById('gender').textContent = currentUser .gender || 'N/A';
            document.getElementById('email').textContent = currentUser .email;
            document.getElementById('phone').textContent = currentUser .phone || 'N/A';
            document.getElementById('location').textContent = `${currentUser .address}, ${currentUser .city}, ${currentUser .state} ${currentUser .zip}` || 'N/A';
    
            document.getElementById('blood-group').textContent = currentUser .bloodGroup || 'N/A';
            document.getElementById('height').textContent = currentUser .height ? `${currentUser .height} cm` : 'N/A';
            document.getElementById('weight').textContent = currentUser .weight ? `${currentUser .weight} kg` : 'N/A';
            document.getElementById('organ-donor').textContent = currentUser .organDonor ? 'Yes' : 'No';
            document.getElementById('organs').textContent = currentUser .organs.length > 0 ? currentUser .organs.join(', ') : 'N/A';
            document.getElementById('medical-history').textContent = currentUser .medicalHistory || 'N/A';
    
            // Populate edit forms
            document.getElementById('edit-first-name').value = currentUser .firstName;
            document.getElementById('edit-last-name').value = currentUser .lastName;
            document.getElementById('edit-dob').value = currentUser .dob || '';
            document.getElementById('edit-gender').value = currentUser .gender || '';
            document.getElementById('edit-email').value = currentUser .email;
            document.getElementById('edit-phone').value = currentUser .phone || '';
            document.getElementById('edit-address').value = `${currentUser .address}, ${currentUser .city}, ${currentUser .state} ${currentUser .zip}`;
    
            document.getElementById('edit-blood-group').value = currentUser .bloodGroup || '';
            document.getElementById('edit-height').value = currentUser .height || '';
            document.getElementById('edit-weight').value = currentUser .weight || '';
            document.getElementById(currentUser .organDonor ? 'edit-organ-donor-yes' : 'edit-organ-donor-no').checked = true;
            currentUser .organs.forEach(organ => document.getElementById(`edit-organ-${organ}`).checked = true);
            document.getElementById('edit-medical-history').value = currentUser .medicalHistory || '';
    
            // Edit functionality
            const editPersonalBtn = document.getElementById('edit-personal-info');
            const cancelPersonalBtn = document.getElementById('cancel-personal-info');
            const savePersonalBtn = document.getElementById('save-personal-info');
            const personalInfoView = document.getElementById ('personal-info-view');
            const personalInfoEdit = document.getElementById('personal-info-edit');
    
            editPersonalBtn.addEventListener('click', function() {
                personalInfoView.style.display = 'none';
                personalInfoEdit.style.display = 'block';
            });
    
            cancelPersonalBtn.addEventListener('click', function() {
                personalInfoView.style.display = 'grid';
                personalInfoEdit.style.display = 'none';
            });
    
            savePersonalBtn.addEventListener('click', function() {
                const updatedUser  = {
                    ...currentUser ,
                    firstName: document.getElementById('edit-first-name').value,
                    lastName: document.getElementById('edit-last-name').value,
                    dob: document.getElementById('edit-dob').value,
                    gender: document.getElementById('edit-gender').value,
                    email: document.getElementById('edit-email').value,
                    phone: document.getElementById('edit-phone').value,
                    address: document.getElementById('edit-address').value.split(', ')[0],
                    city: document.getElementById('edit-address').value.split(', ')[1],
                    state: document.getElementById('edit-address').value.split(', ')[2].split(' ')[0],
                    zip: document.getElementById('edit-address').value.split(' ')[1]
                };
                updateUserData(updatedUser );
                personalInfoView.style.display = 'grid';
                personalInfoEdit.style.display = 'none';
                location.reload();
            });
    
            const editHealthBtn = document.getElementById('edit-health-info');
            const cancelHealthBtn = document.getElementById('cancel-health-info');
            const saveHealthBtn = document.getElementById('save-health-info');
            const healthInfoView = document.getElementById('health-info-view');
            const healthInfoEdit = document.getElementById('health-info-edit');
    
            editHealthBtn.addEventListener('click', function() {
                healthInfoView.style.display = 'none';
                healthInfoEdit.style.display = 'block';
            });
    
            cancelHealthBtn.addEventListener('click', function() {
                healthInfoView.style.display = 'grid';
                healthInfoEdit.style.display = 'none';
            });
    
            saveHealthBtn.addEventListener('click', function() {
                const updatedUser  = {
                    ...currentUser ,
                    bloodGroup: document.getElementById('edit-blood-group').value,
                    height: document.getElementById('edit-height').value || null,
                    weight: document.getElementById('edit-weight').value || null,
                    organDonor: document.getElementById('edit-organ-donor-yes').checked,
                    organs: Array.from(document.querySelectorAll('input[name="organs[]"]:checked')).map(cb => cb.value),
                    medicalHistory: document.getElementById('edit-medical-history').value || ''
                };
                updateUserData(updatedUser );
                healthInfoView.style.display = 'grid';
                healthInfoEdit.style.display = 'none';
                location.reload();
            });
    
            function updateUserData(updatedUser ) {
                const users = JSON.parse(localStorage.getItem('users')) || [];
                const userIndex = users.findIndex(u => u.email.toLowerCase() === currentUser .email.toLowerCase());
                if (userIndex !== -1) {
                    users[userIndex] = updatedUser ;
                    localStorage.setItem('users', JSON.stringify(users));
                    localStorage.setItem('currentUser  ', JSON.stringify(updatedUser )); // Ensure consistent storage
                }
            }
        });
    </script>
    <script src="js/script.js"></script>
</body>
</html>